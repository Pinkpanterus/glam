<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>glam - 360 Video Player</title>
      <style>
          body {
              margin: 0px;
              background-color: #000000;
              overflow: hidden;
          }

          #viewSelect {
              position: absolute;
              top: 0px; 
              padding: 5px;
z-index: 1;
          }

          a {
              color: #ff8800;
          }
      </style>
</head>
<body>
	<div id="container" style="width:98%; height:98%; position:absolute;"></div>
	<select id="viewSelect">
	<option value="[Samsung] 360 video demo trimmed.mp4">Samsung</option>
	<option value="360 Tours Iceland trimmed.mp4">Iceland</option>
	
	</select>

    <script src="./libs/jquery-1.9.1/jquery-1.9.1.js"></script>
	<script src="../../build/glam.js"></script>
	<script>

	var skysphereScript = null;
	
	$(document).ready(function() {
		var container = document.getElementById("container");
		
		var app = new glam.Application({ container : container, riftRender : false });

		// Skybox from http://www.3delyvisions.com/
		// http://www.3delyvisions.com/skf1.htm
		
		var video = document.getElementById( 'video' );

		var texture = new THREE.VideoTexture( video );
		texture.minFilter = THREE.LinearFilter;
		texture.magFilter = THREE.LinearFilter;
		texture.format = THREE.RGBFormat;

		var skysphere = glam.Prefabs.Skysphere();
		skysphereScript = skysphere.getComponent(glam.SkysphereScript);
		skysphereScript.texture = texture;

		app.addObject(skysphere);

		var cam = new glam.PerspectiveCamera(90);
		var camera = new glam.Object;
		camera.addComponent(cam);
		cam.active = true;

		app.addObject(camera);
		
		var controller = glam.Prefabs.ModelController({active:true, headlight:true, 
		});
		var controllerScript = controller.getComponent(glam.ModelControllerScript);
		controllerScript.camera = cam;
		app.addObject(controller);

		var docontroller = glam.Prefabs.DeviceOrientationController({enabled:false});
		var docontrollerScript = docontroller.getComponent(glam.DeviceOrientationControllerScript);
		docontrollerScript.camera = cam;
		app.addObject(docontrollerScript);
				
		app.run();
	}
	);

	var views = document.getElementById("viewSelect");
	views.onchange = function(){

		var url = views.options[views.selectedIndex].value;	
		var video = document.getElementById( 'video' );
		video.src = 'videos/' + url;

		var texture = new THREE.VideoTexture( video );
		texture.minFilter = THREE.LinearFilter;
		texture.magFilter = THREE.LinearFilter;
		texture.format = THREE.RGBFormat;

		skysphereScript.texture = texture;
	}	

	</script>

<video id="video" autoplay loop style="display:none">
	<source src="videos/[Samsung] 360 video demo trimmed.mp4" type='video/mp4'>
</video>
	
</body>
</html>